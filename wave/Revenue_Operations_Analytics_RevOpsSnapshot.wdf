["{\"nodes\":{\"Compute_Comparison_Fields\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when Amount < next('Amount') then 'Amount' - next('Amount') when 'Amount' > next('Amount') then'Amount' -  next('Amount') else 0 end\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"Amount Changes\",\"name\":\"AmountChanges\"},{\"expression\":{\"default\":\"N/A\",\"saqlExpression\":\"case when first('SnapshotDate_day_epoch') - SnapshotDate_day_epoch == 7  && first('Amount') < 'Amount' then number_to_string(first('Amount') - 'Amount', \\\"$#,###\\\") when first('SnapshotDate_day_epoch') - SnapshotDate_day_epoch == 3 && first('Amount') > 'Amount' then number_to_string(first('Amount') - 'Amount', \\\"$#,###\\\") else \\\"unchanged \\\"  end\",\"type\":\"Text\"},\"label\":\"Amount Change 7 days ago\",\"name\":\"AmountChange_7daysago\"},{\"expression\":{\"default\":\"-\",\"saqlExpression\":\"case when 'ForecastCategoryName' != next('ForecastCategoryName') then next('ForecastCategoryName') else \\\"-\\\" end\",\"type\":\"Text\"},\"label\":\"Forecast Category Change\",\"name\":\"ForecastCategoryChange\"},{\"expression\":{\"default\":\"0\",\"saqlExpression\":\"case when 'CloseDate_day_epoch' - next('CloseDate_day_epoch') != 0 then 'CloseDate_day_epoch' - next('CloseDate_day_epoch') else 0 end\",\"type\":\"Numeric\",\"scale\":2},\"label\":\"Close Date Change\",\"name\":\"CloseDateChange\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"SnapshotDate\"}],\"partitionBy\":[\"Id\"]},\"sources\":[\"Slice_Flag_Fields_Opportunity\"]},\"Filter_Source_Data_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"CustomSnapshotFilter:EQ:true\"},\"sources\":[\"Compute_Additional_Flags_Opportunity\"]},\"Compute_Additional_Flags_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Snapshot Text Date\",\"name\":\"SnapshotTextDate\",\"saqlExpression\":\"toString(toDate('SnapshotDate_sec_epoch'),\\\"yyyy-MM-dd\\\")\",\"type\":\"Text\"},{\"label\":\"CustomSnapshotFilter\",\"name\":\"CustomSnapshotFilter\",\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_SnapshotDate_Opportunity\"]},\"Register_Opportunity_Snapshot\":{\"action\":\"register\",\"parameters\":{\"label\":\"Opportunity Snapshot\",\"name\":\"opportunity_snapshot\"},\"sources\":[\"Compute_Comparison_Fields\"]},\"Compute_SnapshotDate_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"format\":\"yyyy-MM-dd\",\"isYearEndFiscalYear\":true,\"label\":\"Snapshot Date\",\"name\":\"SnapshotDate\",\"saqlExpression\":\"toDate(date_to_string(now(),\\\"yyyy-MM-dd\\\"),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Edgemart_Opportunity\"]},\"Edgemart_Snapshot_Opportunity\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"opportunity_snapshot\"}},\"Filter_Duplicate_Snapshot_Dates_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"RemoveDataFlag:EQ:false\"},\"sources\":[\"Compute_RemoveDataFlag_Opportunity\"]},\"Compute_RemoveDataFlag_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"RemoveDataFlag\",\"name\":\"RemoveDataFlag\",\"saqlExpression\":\"case when 'SnapshotTextDate' == date_to_string(now(),\\\"yyyy-MM-dd\\\") || 'SnapshotTextDate' == \\\"1900-01-01\\\" then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Edgemart_Snapshot_Opportunity\"]},\"Edgemart_Opportunity\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"opportunity\"}},\"Filter_Snapshot_Data_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"SnapshotFilter:EQ:true\"},\"sources\":[\"Compute_Snapshot_Filter_Opportunity\"]},\"Slice_Flag_Fields_Opportunity\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"RemoveDataFlag\"},{\"name\":\"SnapshotFilter\"}],\"mode\":\"drop\"},\"sources\":[\"Filter_Snapshot_Data_Opportunity\"]},\"Append_Latest_Snapshot_Opportunity\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Filter_Source_Data_Opportunity\",\"Filter_Duplicate_Snapshot_Dates_Opportunity\"]},\"Compute_Snapshot_Filter_Opportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"SnapshotFilter\",\"name\":\"SnapshotFilter\",\"saqlExpression\":\"case when date_diff(\\\"day\\\", toDate(SnapshotDate_sec_epoch), now()) > 732 then \\\"false\\\" else \\\"true\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Append_Latest_Snapshot_Opportunity\"]}}}",null]